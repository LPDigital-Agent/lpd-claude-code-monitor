<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agent NeuroCenter | Operational Intelligence</title>
    
    <!-- LPD Hive Brand Fonts + Modern Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Space+Grotesk:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Three.js for 3D -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    
    <!-- GSAP for Advanced Animations -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    
    <!-- Socket.io -->
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    
    <!-- Modern CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/neurocenter-modern.css') }}">
</head>
<body>
    <!-- Particle Background -->
    <div class="particles" id="particles"></div>
    
    <!-- Modern Header -->
    <header class="neurocenter-header">
        <!-- Logo Section -->
        <div class="logo-section">
            <div class="logo-container">
                <img src="{{ url_for('static', filename='brand/Símbolo LPDH.png') }}" alt="LPD Hive" style="width: 40px; height: 40px;">
            </div>
            <h1 class="brand-title">
                <span style="color: var(--lpd-orange);">Agent</span> NeuroCenter
            </h1>
            <div class="status-indicator-modern">
                <div class="status-dot-modern"></div>
                <span class="status-label">OPERATIONAL</span>
            </div>
        </div>
        
        <!-- Command Bar -->
        <div class="command-bar">
            <input type="text" class="command-input" placeholder="⌘K Quick command... Try 'investigate payment-dlq' or 'show critical alerts'">
        </div>
        
        <!-- Header Actions -->
        <div class="header-actions">
            <button class="action-btn voice-toggle" id="voice-btn" title="Voice Notifications">
                <i class="fas fa-volume-2"></i>
                <span class="voice-status">ON</span>
            </button>
            <button class="action-btn" id="notifications-btn" title="Notifications">
                <i class="fas fa-bell"></i>
                <span class="notification-badge">3</span>
            </button>
            <button class="action-btn" id="ai-assistant-btn" title="AI Assistant">
                <i class="fas fa-robot"></i>
            </button>
            <button class="action-btn" id="settings-btn" title="Settings">
                <i class="fas fa-cog"></i>
            </button>
        </div>
    </header>
    
    <!-- Tab Navigation -->
    <div class="tab-navigation">
        <button class="tab-btn active" data-tab="dashboard">
            <i class="fas fa-layout-dashboard"></i> Dashboard
        </button>
        <button class="tab-btn" data-tab="glass-room">
            <i class="fas fa-brain"></i> Glass Room
        </button>
        <button class="tab-btn" data-tab="observe">
            <i class="fas fa-eye"></i> Observe Mode
        </button>
        <button class="tab-btn" data-tab="terminal">
            <i class="fas fa-terminal"></i> AI Terminal
        </button>
    </div>
    
    <!-- Main Container -->
    <main class="neurocenter-main-container" id="dashboard-tab">
        <!-- Critical Alerts Bar -->
        <section class="critical-alerts-bar" id="alerts-bar" style="display: none;">
            <div class="alert-content">
                <div class="alert-icon">
                    <i class="fas fa-exclamation-triangle"></i>
                </div>
                <div class="alert-text" id="alert-text">
                    <!-- Dynamic alert text -->
                </div>
            </div>
            <button class="alert-action" onclick="neuroCenter.investigateCritical()">Investigate Now</button>
        </section>
        
        <!-- Left Sidebar - Real-time Queue Status -->
        <aside class="sidebar-left">
            <div class="panel-header">
                <h2 class="panel-title">
                    <i class="fas fa-database"></i>
                    Queue Status
                </h2>
                <button class="action-btn btn-refresh" onclick="neuroCenter.refreshQueues()">
                    <i class="fas fa-sync"></i>
                </button>
            </div>
            
            <!-- Queue List with Real Data -->
            <div class="queue-list-modern" id="queue-sidebar-list">
                <!-- Dynamic queue items from backend -->
            </div>
        </aside>
        
        <!-- Main Content Area -->
        <section class="main-content-area">
            <!-- AWS SQS Queue Monitor with Topology -->
            <div class="aws-queue-monitor-compact">
                <div class="panel-header">
                    <h2 class="panel-title">
                        <i class="fas fa-network-wired"></i>
                        Queue Topology & SQS Monitor
                    </h2>
                    <div class="account-info">
                        <span>Account: 432817839790</span>
                        <span>|</span>
                        <span>Region: sa-east-1</span>
                    </div>
                    <div class="header-actions">
                        <button class="action-btn btn-refresh" onclick="neuroCenter.refreshQueues()">
                            <i class="fas fa-sync"></i> Refresh
                        </button>
                        <button class="action-btn btn-investigate" onclick="neuroCenter.investigateSelected()">
                            <i class="fas fa-search"></i> Investigate
                        </button>
                    </div>
                </div>
                <!-- Queue Topology Visualization -->
                <div class="queue-topology-container">
                    <canvas id="queue-topology-canvas"></canvas>
                    <div class="topology-legend">
                        <span class="legend-item"><i class="fas fa-circle" style="color: var(--lpd-orange);"></i> Source Queue</span>
                        <span class="legend-item"><i class="fas fa-circle" style="color: var(--lpd-wine);"></i> DLQ</span>
                        <span class="legend-item"><i class="fas fa-arrow-right" style="color: var(--lpd-offwhite);"></i> Redrive Policy</span>
                    </div>
                </div>
                <div class="queue-table-container-compact">
                    <table class="queue-table-modern">
                        <thead>
                            <tr>
                                <th><input type="checkbox" id="select-all-queues"></th>
                                <th>Queue Name</th>
                                <th>Type</th>
                                <th>Messages</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="queue-tbody">
                            <!-- Limited to 5 rows with scrollbar -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Live Agent Overview with Real Data -->
            <div class="agent-overview">
                <div class="panel-header">
                    <h2 class="panel-title">
                        <i class="fas fa-robot"></i>
                        Live Agents Working
                    </h2>
                    <div class="header-actions">
                        <button class="action-btn btn-refresh" onclick="neuroCenter.refreshAgents()">
                            <i class="fas fa-sync"></i>
                        </button>
                    </div>
                </div>
                <div class="agent-grid" id="agent-grid">
                    <!-- Real agent status from backend -->
                    <div class="agent-card" data-agent="investigator">
                        <div class="agent-status idle"></div>
                        <div class="agent-name">Investigation Agent</div>
                        <div class="agent-task">Idle</div>
                    </div>
                    <div class="agent-card" data-agent="analyzer">
                        <div class="agent-status idle"></div>
                        <div class="agent-name">DLQ Analyzer</div>
                        <div class="agent-task">Idle</div>
                    </div>
                    <div class="agent-card" data-agent="debugger">
                        <div class="agent-status idle"></div>
                        <div class="agent-name">Code Debugger</div>
                        <div class="agent-task">Idle</div>
                    </div>
                    <div class="agent-card" data-agent="reviewer">
                        <div class="agent-status idle"></div>
                        <div class="agent-name">Code Reviewer</div>
                        <div class="agent-task">Idle</div>
                    </div>
                </div>
            </div>
            
            <!-- Dead Letter Queues -->
            <div class="dlq-section">
                <div class="panel-header">
                    <h2 class="panel-title">
                        <i class="fas fa-exclamation-triangle"></i>
                        Dead Letter Queues
                    </h2>
                    <div class="dlq-badges">
                        <span class="badge-critical" id="dlq-critical">0</span>
                        <span class="badge-warning" id="dlq-warning">0</span>
                        <span class="badge-ok" id="dlq-ok">0</span>
                    </div>
                </div>
                <div class="dlq-grid" id="dlq-grid">
                    <!-- Dynamic DLQ cards -->
                </div>
            </div>
            
            
            <!-- Live Metrics Dashboard with Real Data -->
            <div class="live-metrics-section">
                <div class="panel-header">
                    <h2 class="panel-title">
                        <i class="fas fa-chart-line"></i>
                        Live Metrics
                    </h2>
                </div>
                <div class="metrics-grid-modern">
                    <div class="metric-card-modern">
                        <div class="metric-icon-modern">
                            <i class="fas fa-robot"></i>
                        </div>
                        <div class="metric-value-modern" id="metric-active-agents">0</div>
                        <div class="metric-label-modern">Active Agents</div>
                        <div class="metric-change" id="metric-agents-change">--</div>
                    </div>
                    
                    <div class="metric-card-modern">
                        <div class="metric-icon-modern">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="metric-value-modern" id="metric-avg-time">--</div>
                        <div class="metric-label-modern">Avg Resolution</div>
                        <div class="metric-change" id="metric-time-change">--</div>
                    </div>
                    
                    <div class="metric-card-modern">
                        <div class="metric-icon-modern">
                            <i class="fas fa-code-branch"></i>
                        </div>
                        <div class="metric-value-modern" id="metric-prs">0</div>
                        <div class="metric-label-modern">PRs Today</div>
                        <div class="metric-change" id="metric-prs-change">--</div>
                    </div>
                    
                    <div class="metric-card-modern">
                        <div class="metric-icon-modern">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="metric-value-modern" id="metric-success">--</div>
                        <div class="metric-label-modern">Success Rate</div>
                        <div class="metric-change" id="metric-success-change">--</div>
                    </div>
                </div>
            
            <!-- Investigation Timeline -->
            <div class="investigation-timeline-section">
                <div class="panel-header">
                    <h2 class="panel-title">
                        <i class="fas fa-history"></i>
                        Investigation Timeline
                    </h2>
                    <select class="filter-select" id="timeline-filter">
                        <option value="all">All Investigations</option>
                        <option value="active">Active</option>
                        <option value="completed">Completed</option>
                    </select>
                </div>
                <div class="timeline-container" id="investigation-timeline">
                    <!-- Dynamic timeline entries -->
                </div>
            </div>
            
            <!-- Recent Actions -->
            <div class="recent-actions-section">
                <div class="panel-header">
                    <h2 class="panel-title">
                        <i class="fas fa-bolt"></i>
                        Recent Actions
                    </h2>
                </div>
                <div class="actions-list" id="recent-actions">
                    <!-- Dynamic action items -->
                </div>
            </div>
            
            <!-- Pull Request Management -->
            <div class="pr-management-section">
                <div class="panel-header">
                    <h2 class="panel-title">
                        <i class="fas fa-code-branch"></i>
                        Pull Requests
                    </h2>
                    <div class="pr-stats">
                        <span class="pr-open">Open: <span id="pr-open-count">0</span></span>
                        <span class="pr-merged">Merged: <span id="pr-merged-count">0</span></span>
                    </div>
                </div>
                <div class="pr-list" id="pr-list">
                    <!-- Dynamic PR cards -->
                </div>
            </div>
            
            <!-- Activity Timeline with Real Events -->
            <div class="timeline-modern">
                <div class="panel-header">
                    <h2 class="panel-title">
                        <i class="fas fa-stream"></i>
                        Live Activity Stream
                    </h2>
                </div>
                <div class="timeline-track" id="activity-timeline">
                    <!-- Dynamic timeline events from backend -->
                </div>
            </div>
        </section>
        
        <!-- Right Sidebar - System Status -->
        <aside class="right-sidebar">
            <div class="panel-header">
                <h2 class="panel-title">
                    <i class="fas fa-chart-bar"></i>
                    System Status
                </h2>
            </div>
            
            <!-- System Health -->
            <div class="status-card">
                <h3>System Health</h3>
                <div class="health-indicators">
                    <div class="health-item">
                        <span class="health-label">AWS Connection</span>
                        <span class="health-status" id="aws-status">Connected</span>
                    </div>
                    <div class="health-item">
                        <span class="health-label">Database</span>
                        <span class="health-status" id="db-status">Active</span>
                    </div>
                    <div class="health-item">
                        <span class="health-label">Agent Framework</span>
                        <span class="health-status" id="agent-status">Running</span>
                    </div>
                </div>
            </div>
            
            <!-- Recent Events -->
            <div class="status-card">
                <h3>Recent Events</h3>
                <div class="events-list" id="recent-events">
                    <!-- Dynamic recent events -->
                </div>
            </div>
        </aside>
    </main>
    
    <!-- Glass Room Tab -->
    <div class="tab-content" id="glass-room-tab">
        <div class="glass-room-container">
            <!-- Agent Activity Feed -->
            <div class="glass-panel activity-feed">
                <div class="panel-header-glass">
                    <h3><i class="fas fa-stream"></i> Agent Activity Feed</h3>
                    <div class="feed-controls">
                        <button class="btn-filter active" data-filter="all">All</button>
                        <button class="btn-filter" data-filter="critical">Critical</button>
                        <button class="btn-filter" data-filter="insights">Insights</button>
                    </div>
                </div>
                <div class="feed-container" id="agent-activity-feed">
                    <!-- Natural language agent updates will appear here -->
                </div>
            </div>
            
            <!-- Context Storyline -->
            <div class="glass-panel context-storyline">
                <div class="panel-header-glass">
                    <h3><i class="fas fa-book-open"></i> Context Storyline</h3>
                </div>
                <div class="storyline-container" id="context-storyline">
                    <!-- Case narratives will appear here -->
                </div>
            </div>
            
            <!-- Agent Constellation -->
            <div class="glass-panel agent-constellation">
                <div class="panel-header-glass">
                    <h3><i class="fas fa-network-wired"></i> Agent Constellation</h3>
                </div>
                <div class="constellation-container" id="agent-constellation">
                    <canvas id="constellation-canvas"></canvas>
                </div>
            </div>
            
            <!-- System Pulse -->
            <div class="glass-panel system-pulse">
                <div class="panel-header-glass">
                    <h3><i class="fas fa-heartbeat"></i> System Pulse</h3>
                </div>
                <div class="pulse-container">
                    <div class="pulse-metric">
                        <span class="pulse-label">Queue Health</span>
                        <div class="pulse-bar">
                            <div class="pulse-fill" style="width: 85%;"></div>
                        </div>
                    </div>
                    <div class="pulse-metric">
                        <span class="pulse-label">Agent Efficiency</span>
                        <div class="pulse-bar">
                            <div class="pulse-fill" style="width: 92%;"></div>
                        </div>
                    </div>
                    <div class="pulse-metric">
                        <span class="pulse-label">Resolution Rate</span>
                        <div class="pulse-bar">
                            <div class="pulse-fill" style="width: 78%;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Observe Mode Tab -->
    <div class="tab-content" id="observe-tab">
        <div class="observe-container">
            <div class="cinematic-view" id="cinematic-view">
                <canvas id="observe-canvas"></canvas>
                <div class="observe-overlay">
                    <div class="observe-status">
                        <span class="observe-agent-name">Investigation Agent</span>
                        <span class="observe-agent-action">Analyzing error patterns...</span>
                    </div>
                </div>
            </div>
            <div class="observe-controls">
                <button class="btn-play" id="play-pause"><i class="fas fa-play"></i></button>
                <button class="btn-speed active" data-speed="1x">1x</button>
                <button class="btn-speed" data-speed="2x">2x</button>
                <button class="btn-speed" data-speed="0.5x">0.5x</button>
                <div class="observe-timeline">
                    <div class="timeline-progress"></div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- AI Terminal Tab -->
    <div class="tab-content" id="terminal-tab">
        <div class="terminal-container">
            <div class="terminal-output" id="terminal-output">
                <div class="terminal-welcome">
                    <pre>
╔══════════════════════════════════════════════════════════════════╗
║           Agent NeuroCenter AI Terminal v2.0                     ║
║           Your window into the mind of your agents               ║
╚══════════════════════════════════════════════════════════════════╝

Type 'help' for available commands or ask questions in natural language.

Examples:
  > What's happening with the payment-dlq?
  > Show me all active investigations
  > Why did the last investigation fail?
  > Start investigation for order-dlq
  > Show agent performance metrics
                    </pre>
                </div>
            </div>
            <div class="terminal-input-container">
                <span class="terminal-prompt">neurocenter@ai &gt;</span>
                <input type="text" class="terminal-input" id="terminal-input" placeholder="Ask about agents, incidents, or type commands...">
            </div>
        </div>
    </div>
    
    <!-- Advanced JavaScript -->
    <script src="{{ url_for('static', filename='js/neurocenter-modern.js') }}"></script>
</body>
</html>